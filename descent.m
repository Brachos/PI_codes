%% Code based on Gudmundsson book page 915
